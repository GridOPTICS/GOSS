<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:amq="http://activemq.apache.org/schema/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
  		http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd">

	<bean
		class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" />

	<broker xmlns="http://activemq.apache.org/schema/core"
		brokerName="dynamic-broker1" persistent="false" >

		<systemUsage>
			<systemUsage>
				<tempUsage>
					<tempUsage limit="100 mb" />
				</tempUsage>
			</systemUsage>
		</systemUsage>

		<managementContext>
			<managementContext createConnector="true" />
		</managementContext>

		<transportConnectors>
			<transportConnector name="openwire" uri="tcp://0.0.0.0:61618"/>
		</transportConnectors>

		<plugins>
		 	<jaasAuthenticationPlugin configuration="LDAPLogin" />
			 <!---->  <authorizationPlugin>
		        <map>
		          <bean id="lDAPAuthorizationMap" class="org.apache.activemq.security.LDAPAuthorizationMap"
		                xmlns="http://www.springframework.org/schema/beans">
		            <property name="initialContextFactory" value="com.sun.jndi.ldap.LdapCtxFactory"/>
		            <property name="connectionURL" value="ldap://localhost:10389"/>
		            <property name="authentication" value="simple"/>
		            <property name="connectionUsername" value="uid=admin,ou=system"/>
		            <property name="connectionPassword" value="rootpass"/>
		            <property name="connectionProtocol" value=""/>
		            <property name="topicSearchMatchingFormat"
		                      value="cn={0},ou=Topic,ou=Destination,ou=ActiveMQ,ou=system"/>
		            <property name="topicSearchSubtreeBool" value="true"/>
		            <property name="queueSearchMatchingFormat"
		                      value="cn={0},ou=Queue,ou=Destination,ou=ActiveMQ,ou=system"/>
		            <property name="queueSearchSubtreeBool" value="true"/>
		            <property name="advisorySearchBase"
		                      value="cn=ActiveMQ.Advisory,ou=Topic,ou=Destination,ou=ActiveMQ,ou=system"/>
		            <property name="tempSearchBase"
		                      value="cn=ActiveMQ.Temp,ou=Topic,ou=Destination,ou=ActiveMQ,ou=system"/>
		            <property name="adminBase" value="(cn=admin)"/>
		            <property name="adminAttribute" value="member"/>
		            <property name="readBase" value="(cn=read)"/>
		            <property name="readAttribute" value="member"/>
		            <property name="writeBase" value="(cn=write)"/>
		            <property name="writeAttribute" value="member"/>
		          </bean>
		        </map>
	          </authorizationPlugin>
	           
	          <bean xmlns="http://www.springframework.org/schema/beans" id="gossSecurityBroker" class="pnnl.goss.security.core.GossSecurityBroker">
		    	</bean>
	    </plugins>
	    
		<messageAuthorizationPolicy>
		    <bean class="pnnl.goss.security.core.activemq.GossAuthPolicy"
		          xmlns="http://www.springframework.org/schema/beans"/>
		</messageAuthorizationPolicy>


	</broker>

</beans>
