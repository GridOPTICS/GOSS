<?xml version="1.0" encoding="UTF-8"?>
<features xmlns="http://karaf.apache.org/xmlns/features/v1.2.0"  name="${project.artifactId}-${project.version}" >

    <feature name="goss-ipojo" version="${ipojo.version}">
    	<feature>goss-dependencies</feature>
        <bundle>mvn:org.apache.felix/org.apache.felix.ipojo.api/${ipojo.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.ipojo/${ipojo.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.ipojo.gogo/${ipojo.version}</bundle>
        <bundle>mvn:org.apache.felix/org.apache.felix.ipojo.composite/${ipojo.version}</bundle>
    </feature>
    
    <feature name="goss-activemq-broker-nosecurity" version="${project.version}">
        <feature version="${activemq.version}">activemq</feature>
        <configfile finalname="/etc/org.apache.activemq.server-default.cfg">
        	mvn:pnnl.goss/goss-core-features/${project.version}/cfg/goss-broker-config
        </configfile>        
        <configfile finalname="/etc/pnnl-goss-activemq-broker.xml">
        	mvn:pnnl.goss/goss-core-features/${project.version}/xml/goss-broker-nosecurity
        </configfile>
    </feature>
        
    <feature name="goss-dependencies" version="${project.version}">
    	<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.xstream/${servicemix-xstream.version}</bundle>
    	<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-io/${servicemix-commons-io.version}</bundle>
    	<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.commons-dbcp/${servicemix-commons-dbcp.version}</bundle>
    	<bundle dependency="true">mvn:com.google.code.gson/gson/${gson.version}</bundle>
    	<bundle dependency="true">mvn:mysql/mysql-connector-java/${mysql-connector.version}</bundle>
    	<bundle dependency="true">mvn:org.apache.httpcomponents/httpcore-osgi/${httpclient-osgi.version}</bundle>
    	<bundle dependency="true">mvn:org.apache.httpcomponents/httpclient-osgi/${httpclient-osgi.version}</bundle>
    	
    	<bundle dependency="true">mvn:org.fusesource.stompjms/stompjms-client/${stompjms.version}</bundle>
  		<bundle dependency="true">mvn:org.fusesource.hawtdispatch/hawtdispatch-transport/${hawt.version}</bundle>
    	<bundle dependency="true">mvn:org.fusesource.hawtdispatch/hawtdispatch/${hawt.version}</bundle>
  		<bundle dependency="true">mvn:org.fusesource.hawtbuf/hawtbuf/${hawtbuf.version}</bundle>
  		<bundle dependency="true">mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.reflections/0.9.8_1</bundle>
  		<feature>openjpa</feature>
  		<feature>jndi</feature>
    </feature>

    <feature name="goss-core-feature" version="${project.version}">
    	<configfile finalname="/etc/pnnl.goss.core.cfg">
        	mvn:pnnl.goss/goss-core-features/${project.version}/cfg/goss-core
        </configfile>
        <configfile finalname="/etc/pnnl.goss.datasources.cfg">
        	mvn:pnnl.goss/goss-core-features/${project.version}/cfg/goss-datasources
        </configfile>
    	<feature>goss-dependencies</feature>
    	<feature>goss-ipojo</feature>
    	<feature version="${cxf.version}">cxf</feature>
    	    	
    	<!-- Installs all the necessary activemq info for the broker and web-console -->
    	<bundle start-level="80" dependency="true">mvn:pnnl.goss/goss-core-security-utils/${project.version}</bundle>
    	   	
    	<bundle start-level="84" dependency="true">mvn:pnnl.goss/goss-core/${project.version}</bundle>
    	<bundle start-level="85" dependency="true">mvn:pnnl.goss/goss-core-client/${project.version}</bundle>    	    	
    	<bundle start-level="86" dependency="true">mvn:pnnl.goss/goss-core-security/${project.version}</bundle>
    	<bundle start-level="87" dependency="true">mvn:pnnl.goss/goss-core-server/${project.version}</bundle>

    </feature>   
    
    <feature name="goss-core-web-feature" version="${project.version}">
    	<feature>goss-core-feature</feature>
    	<feature>http</feature>
    	<feature>war</feature>
    	
    	<bundle dependency="true" start-level="88">mvn:pnnl.goss/goss-core-web/${project.version}/war</bundle>
    </feature>
</features>
